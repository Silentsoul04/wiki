
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="anakilivo">
      
      
      <link rel="shortcut icon" href="../../../assets/horde.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.7">
    
    
      
        <title>PNG - Horde Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.39b8e14a.min.css">
        
          
          
          <meta name="theme-color" content="#ef5552">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#file-format" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../.." title="Horde Wiki" class="md-header-nav__button md-logo" aria-label="Horde Wiki">
      
  <img src="../../../assets/horde.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Horde Wiki
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              PNG
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/anakilivo/wiki/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"/></svg>
  </div>
  <div class="md-source__repository">
    anakilivo/wiki
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Horde Wiki" class="md-nav__button md-logo" aria-label="Horde Wiki">
      
  <img src="../../../assets/horde.png" alt="logo">

    </a>
    Horde Wiki
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/anakilivo/wiki/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"/></svg>
  </div>
  <div class="md-source__repository">
    anakilivo/wiki
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
      
      <label class="md-nav__link" for="nav-2">
        Misc
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Misc" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          Misc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1" >
      
      <label class="md-nav__link" for="nav-2-1">
        Archive
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Archive" data-md-level="2">
        <label class="md-nav__title" for="nav-2-1">
          <span class="md-nav__icon md-icon"></span>
          Archive
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../archive/rar" class="md-nav__link">
        Rar
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../archive/zip" class="md-nav__link">
        Zip
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2" >
      
      <label class="md-nav__link" for="nav-2-2">
        Audio
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Audio" data-md-level="2">
        <label class="md-nav__title" for="nav-2-2">
          <span class="md-nav__icon md-icon"></span>
          Audio
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../audio/introduction" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3" >
      
      <label class="md-nav__link" for="nav-2-3">
        Disc Memory
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Disc Memory" data-md-level="2">
        <label class="md-nav__title" for="nav-2-3">
          <span class="md-nav__icon md-icon"></span>
          Disc Memory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../disk-memory/introduction" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4" >
      
      <label class="md-nav__link" for="nav-2-4">
        Encode
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Encode" data-md-level="2">
        <label class="md-nav__title" for="nav-2-4">
          <span class="md-nav__icon md-icon"></span>
          Encode
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../encode/communication" class="md-nav__link">
        Communication
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../encode/encodings" class="md-nav__link">
        Encodings
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../encode/modern" class="md-nav__link">
        Modern
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5" checked>
      
      <label class="md-nav__link" for="nav-2-5">
        Pictures
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pictures" data-md-level="2">
        <label class="md-nav__title" for="nav-2-5">
          <span class="md-nav__icon md-icon"></span>
          Pictures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../introduction" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../jpg" class="md-nav__link">
        JPG (JPEG)
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          PNG
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="" class="md-nav__link md-nav__link--active">
        PNG
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#file-format" class="md-nav__link">
    File format
  </a>
  
    <nav class="md-nav" aria-label="File format">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-block-chunk" class="md-nav__link">
    Data block (chunk)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ihdr" class="md-nav__link">
    IHDR
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
    <nav class="md-nav" aria-label="Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plte" class="md-nav__link">
    PLTE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#idat" class="md-nav__link">
    IDAT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iend" class="md-nav__link">
    IEND
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remaining-auxiliary-data-blocks" class="md-nav__link">
    Remaining auxiliary data blocks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lsb" class="md-nav__link">
    LSB
  </a>
  
    <nav class="md-nav" aria-label="LSB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    Tools
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gif" class="md-nav__link">
        GIF
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6" >
      
      <label class="md-nav__link" for="nav-2-6">
        Other
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Other" data-md-level="2">
        <label class="md-nav__title" for="nav-2-6">
          <span class="md-nav__icon md-icon"></span>
          Other
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/pyc" class="md-nav__link">
        Pyc
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
      
      <label class="md-nav__link" for="nav-3">
        Web
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Web" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Web
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/introduction" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/php" class="md-nav__link">
        PHP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/sqli" class="md-nav__link">
        Sqli
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/xss" class="md-nav__link">
        XSS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/ssrf" class="md-nav__link">
        SSRF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/csrf" class="md-nav__link">
        CSRF
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
      
      <label class="md-nav__link" for="nav-4">
        Crypto
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Crypto" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          Crypto
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/introduction" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2" >
      
      <label class="md-nav__link" for="nav-4-2">
        Asimmetric
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Asimmetric" data-md-level="2">
        <label class="md-nav__title" for="nav-4-2">
          <span class="md-nav__icon md-icon"></span>
          Asimmetric
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-2-1" type="checkbox" id="nav-4-2-1" >
      
      <label class="md-nav__link" for="nav-4-2-1">
        Lattice
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Lattice" data-md-level="3">
        <label class="md-nav__title" for="nav-4-2-1">
          <span class="md-nav__icon md-icon"></span>
          Lattice
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/lattice/introduction" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/lattice/overview" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/lattice/lattice-reduction" class="md-nav__link">
        Lattice reduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/lattice/cvp" class="md-nav__link">
        CVP
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-2-2" type="checkbox" id="nav-4-2-2" >
      
      <label class="md-nav__link" for="nav-4-2-2">
        Discrete Log
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Discrete Log" data-md-level="3">
        <label class="md-nav__title" for="nav-4-2-2">
          <span class="md-nav__icon md-icon"></span>
          Discrete Log
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/discrete-log/introduction" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/discrete-log/elgamal" class="md-nav__link">
        ElGamal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/discrete-log/ecc" class="md-nav__link">
        ECC
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-2-3" type="checkbox" id="nav-4-2-3" >
      
      <label class="md-nav__link" for="nav-4-2-3">
        Rsa
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Rsa" data-md-level="3">
        <label class="md-nav__title" for="nav-4-2-3">
          <span class="md-nav__icon md-icon"></span>
          Rsa
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/rsa/introduction" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/knapsack" class="md-nav__link">
        Knapsack
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#file-format" class="md-nav__link">
    File format
  </a>
  
    <nav class="md-nav" aria-label="File format">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-block-chunk" class="md-nav__link">
    Data block (chunk)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ihdr" class="md-nav__link">
    IHDR
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
    <nav class="md-nav" aria-label="Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plte" class="md-nav__link">
    PLTE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#idat" class="md-nav__link">
    IDAT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iend" class="md-nav__link">
    IEND
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remaining-auxiliary-data-blocks" class="md-nav__link">
    Remaining auxiliary data blocks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lsb" class="md-nav__link">
    LSB
  </a>
  
    <nav class="md-nav" aria-label="LSB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    Tools
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/anakilivo/wiki/edit/main/docs/misc/pictures/png.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>PNG</h1>
                
                <ul>
<li><a href="../png.ru">русский</a></li>
</ul>
<h2 id="file-format">File format</h2>
<p>For a <code>PNG</code> file, the file header is always described by fixed-bit bytes, and the remaining part is composed of more
than 3 <code>PNG</code> data blocks (chunks) in a specific order.</p>
<p>File header <code>89 50 4E 47 0D 0A 1A 0A</code> + data block + data block + data block...</p>
<h3 id="data-block-chunk">Data block (chunk)</h3>
<p><code>PNG</code> defines two types of data blocks, one is called critical chunks, which are standard data blocks, and the other is
called ancillary chunks, which are optional data blocks. The key data block defines 4 standard data blocks, each <code>PNG</code>
file must contain them, and PNG reading and writing software must also support these data blocks.</p>
<table>
<thead>
<tr>
<th align="center">Data block signature</th>
<th align="center">Data block name</th>
<th align="center">Multiple data blocks</th>
<th align="center">Optional</th>
<th align="center">Location restrictions</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">IHDR</td>
<td align="center">File header data block</td>
<td align="center"><img alt="❌" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/274c.png" title=":x:" /></td>
<td align="center"><img alt="❌" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/274c.png" title=":x:" /></td>
<td align="center">First piece</td>
</tr>
<tr>
<td align="center">cHRM</td>
<td align="center">Base color and white point data block</td>
<td align="center"><img alt="❌" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/274c.png" title=":x:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">Before PLTE and IDAT</td>
</tr>
<tr>
<td align="center">gAMA</td>
<td align="center">Image data block</td>
<td align="center"><img alt="❌" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/274c.png" title=":x:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">Before PLTE and IDAT</td>
</tr>
<tr>
<td align="center">sBIT</td>
<td align="center">Sample effective bit data block</td>
<td align="center"><img alt="❌" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/274c.png" title=":x:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">Before PLTE and IDAT</td>
</tr>
<tr>
<td align="center">PLTE</td>
<td align="center">Palette data block</td>
<td align="center"><img alt="❌" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/274c.png" title=":x:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">Before IDAT</td>
</tr>
<tr>
<td align="center">bKGD</td>
<td align="center">Background color data block</td>
<td align="center"><img alt="❌" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/274c.png" title=":x:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">After PLTE before IDAT</td>
</tr>
<tr>
<td align="center">hIST</td>
<td align="center">Image histogram data block</td>
<td align="center"><img alt="❌" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/274c.png" title=":x:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">After PLTE before IDAT</td>
</tr>
<tr>
<td align="center">tRNS</td>
<td align="center">Image transparent data block</td>
<td align="center"><img alt="❌" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/274c.png" title=":x:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">After PLTE before IDAT</td>
</tr>
<tr>
<td align="center">oFFs</td>
<td align="center">Private public data block</td>
<td align="center"><img alt="❌" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/274c.png" title=":x:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">Before IDAT</td>
</tr>
<tr>
<td align="center">pHYs</td>
<td align="center">Physical pixel size data block</td>
<td align="center"><img alt="❌" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/274c.png" title=":x:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">Before IDAT</td>
</tr>
<tr>
<td align="center">sCAL</td>
<td align="center">Private public data block</td>
<td align="center"><img alt="❌" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/274c.png" title=":x:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">Before IDAT</td>
</tr>
<tr>
<td align="center">IDAT</td>
<td align="center">Image data block</td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center"><img alt="❌" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/274c.png" title=":x:" /></td>
<td align="center">Continuous with other IDAT</td>
</tr>
<tr>
<td align="center">tIME</td>
<td align="center">Image last modified time data block</td>
<td align="center"><img alt="❌" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/274c.png" title=":x:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">Unlimited</td>
</tr>
<tr>
<td align="center">tEXt</td>
<td align="center">Text message data block</td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">Unlimited</td>
</tr>
<tr>
<td align="center">zTXt</td>
<td align="center">Compressed text data block</td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">Unlimited</td>
</tr>
<tr>
<td align="center">fRAc</td>
<td align="center">Private public data block</td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">Unlimited</td>
</tr>
<tr>
<td align="center">gIFg</td>
<td align="center">Private public data block</td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">Unlimited</td>
</tr>
<tr>
<td align="center">gIFt</td>
<td align="center">Private public data block</td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">Unlimited</td>
</tr>
<tr>
<td align="center">gIFx</td>
<td align="center">Private public data block</td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center"><img alt="✅" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/2705.png" title=":white_check_mark:" /></td>
<td align="center">Unlimited</td>
</tr>
<tr>
<td align="center">IEND</td>
<td align="center">End of image data</td>
<td align="center"><img alt="❌" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/274c.png" title=":x:" /></td>
<td align="center"><img alt="❌" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/72x72/274c.png" title=":x:" /></td>
<td align="center">Last data block</td>
</tr>
</tbody>
</table>
<p>There is a unified data structure for each data block, and each data block consists of 4 parts</p>
<table>
<thead>
<tr>
<th align="center">Name</th>
<th align="center">Bytes</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Length</td>
<td align="center">4</td>
<td align="center">Specify the length of the data field in the data block, and its length does not exceed (231-1) bytes</td>
</tr>
<tr>
<td align="center">Chunk Type Code</td>
<td align="center">4</td>
<td align="center">The data block type code consists of ASCII letters (A-Z and a-z)</td>
</tr>
<tr>
<td align="center">Chunk Data</td>
<td align="center">Variable</td>
<td align="center">Store data specified in accordance with Chunk Type Code</td>
</tr>
<tr>
<td align="center">CRC</td>
<td align="center">4</td>
<td align="center">Store the cyclic redundancy code used to detect errors</td>
</tr>
</tbody>
</table>
<p>The value in the CRC (Cyclic Redundancy Check) field is calculated from the data in the Chunk Type Code field and Chunk
Data field.</p>
<h3 id="ihdr">IHDR</h3>
<p>File header data block <code>IHDR</code> (Header Chunk): It contains the basic information of the image data stored in the <code>PNG</code> 
file. It is composed of 13 bytes and appears as the first data block in the <code>PNG</code> data stream, and a <code>PNG</code> data stream.
There can only be one file header data block in</p>
<p>Among them, we are concerned about the content of the first 8 bytes</p>
<table>
<thead>
<tr>
<th align="center">Dimension name</th>
<th align="center">Bytes</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Width</td>
<td align="center">4</td>
<td align="center">Image width, in pixels</td>
</tr>
<tr>
<td align="center">Height</td>
<td align="center">4</td>
<td align="center">Image height in pixels</td>
</tr>
</tbody>
</table>
<p>We often change the height or width of a picture to make a picture incomplete to achieve the purpose of hiding
information.</p>
<p><img alt="pngihdr" src="../../../assets/img/pictures/pngihdr.png" /></p>
<p>It can be found that this picture cannot be opened in Kali, prompting <code>IHDR CRC error</code>, and the picture viewer that
comes with Windows 10 can be opened, which reminds us that the <code>IHDR</code> block has been artificially tampered with, so we 
try to modify the picture. The height or width of the hidden string is found.</p>
<h2 id="example">Example</h2>
<details class="example"><summary>WDCTF-finals-2017</summary><p>Observing the file, you can find that the file header and width are abnormal</p>
<div class="highlight"><pre><span></span><code>00000000  80 59 4e 47 0d 0a 1a 0a  00 00 00 0d 49 48 44 52  |.YNG........IHDR|
00000010  00 00 00 00 00 00 02 f8  08 06 00 00 00 93 2f 8a  |............../.|
00000020  6b 00 00 00 04 67 41 4d  41 00 00 9c 40 20 0d e4  |k....gAMA...@ ..|
00000030  cb 00 00 00 20 63 48 52  4d 00 00 87 0f 00 00 8c  |.... cHRM.......|
00000040  0f 00 00 fd 52 00 00 81  40 00 00 7d 79 00 00 e9  |....R...@..}y...|
...
</code></pre></div>
<p>It should be noted here that the file width cannot be arbitrarily modified. It needs to be blasted to get the width
according to the CRC value of the <code>IHDR</code> block, otherwise the image display error cannot get the flag.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">import</span> <span class="nn">struct</span>

<span class="n">misc</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;misc4.png&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1024</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">misc</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span> <span class="o">+</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&gt;i&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">misc</span><span class="p">[</span><span class="mi">20</span><span class="p">:</span><span class="mi">29</span><span class="p">]</span>
    <span class="n">crc32</span> <span class="o">=</span> <span class="n">binascii</span><span class="o">.</span><span class="n">crc32</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
    <span class="k">if</span> <span class="n">crc32</span> <span class="o">==</span> <span class="mh">0x932f8a6b</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</code></pre></div>
<p>After getting the width value of 709, restore the picture to get the flag.</p>
<p><img alt="" src="../../../assets/img/pictures/misc4.png" /></p>
</details>
<h3 id="plte">PLTE</h3>
<p>The palette data block <code>PLTE</code> (palette chunk): It contains the color transformation data related to the indexed-color
image. It is only related to the indexed-color image and should be placed in the image data chunk. The true
color <code>PNG</code> data stream can also have palette data blocks, the purpose is to facilitate non-true color display programs
to use it to quantify the image data, thereby displaying the image.</p>
<h3 id="idat">IDAT</h3>
<p>Image data chunk <code>IDAT</code> (image data chunk): It stores actual data, and the data stream can contain multiple consecutive
image data chunks.</p>
<ul>
<li>Store image number data</li>
<li>The data stream can contain multiple consecutive image data blocks</li>
<li>Compression using a derived algorithm of the <code>LZ77</code> algorithm</li>
<li>Can be decompressed with <code>zlib</code></li>
</ul>
<p>It is worth noting that the <code>IDAT</code> block will only continue with a new block when the previous block is full.</p>
<p>Use <code>pngcheck</code> to view this <code>PNG</code> file</p>
<div class="highlight"><pre><span></span><code>λ .<span class="se">\p</span>ngcheck.exe -v sctf.png
File: sctf.png <span class="o">(</span><span class="m">1421461</span> bytes<span class="o">)</span>
  chunk IHDR at offset 0x0000c, length <span class="m">13</span>
    <span class="m">1000</span> x <span class="m">562</span> image, <span class="m">32</span>-bit RGB+alpha, non-interlaced
  chunk sRGB at offset 0x00025, length <span class="m">1</span>
    rendering <span class="nv">intent</span> <span class="o">=</span> perceptual
  chunk gAMA at offset 0x00032, length <span class="m">4</span>: <span class="m">0</span>.45455
  chunk pHYs at offset 0x00042, length <span class="m">9</span>: 3780x3780 pixels/meter <span class="o">(</span><span class="m">96</span> dpi<span class="o">)</span>
  chunk IDAT at offset 0x00057, length <span class="m">65445</span>
    zlib: deflated, 32K window, fast compression
  chunk IDAT at offset 0x10008, length <span class="m">65524</span>
...
  chunk IDAT at offset 0x150008, length <span class="m">45027</span>
  chunk IDAT at offset 0x15aff7, length <span class="m">138</span>
  chunk IEND at offset 0x15b08d, length <span class="m">0</span>
No errors detected <span class="k">in</span> sctf.png <span class="o">(</span><span class="m">28</span> chunks, <span class="m">36</span>.8% compression<span class="o">)</span>.
</code></pre></div>
<p>As you can see, the length of the normal block is full at 65524, while the length of the penultimate IDAT block is
45027, and the length of the last is 138. Obviously the last IDAT block is problematic because it should have been
Merged into the penultimate block that is not full.</p>
<p>Use <code>python zlib</code> to decompress the content of the redundant <code>IDAT</code> block. At this time, pay attention to removing the
length, data block type and the <code>CRC</code> check value at the end.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">zlib</span>
<span class="kn">import</span> <span class="nn">binascii</span>

<span class="n">IDAT</span> <span class="o">=</span> <span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="s2">&quot;789...667&quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">binascii</span><span class="o">.</span><span class="n">hexlify</span><span class="p">(</span><span class="n">zlib</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">IDAT</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div>
<h3 id="iend">IEND</h3>
<p>Image end data <code>IEND</code> (image trailer chunk): It is used to mark the end of the <code>PNG</code> file or data stream, and must be 
placed at the end of the file.</p>
<div class="highlight"><pre><span></span><code>00 00 00 00 49 45 4E 44 AE 42 60 82
</code></pre></div>
<p>The length of the <code>IEND</code> data block is always <code>00 00 00 00</code>, and the data identifier is always <code>IEND</code> <code>49 45 4E 44</code>.
Therefore, the <code>CRC</code> code is always <code>AE 42 60 82</code>.</p>
<h3 id="remaining-auxiliary-data-blocks">Remaining auxiliary data blocks</h3>
<ul>
<li>bKGD（background color）</li>
<li>cHRM（primary chromaticities and white point），The so-called whiteness refers to the whiteness produced on the display
  when R=G=B=maximum</li>
<li>gAMA（image gamma）</li>
<li>hIST（image histogram）</li>
<li>pHYs（physical pixel dimensions）</li>
<li>sBIT（significant bits）</li>
<li>tEXt（textual data）</li>
<li>tIME （image last-modification time）</li>
<li>tRNS （transparency）</li>
<li>zTXt （compressed textual data）</li>
</ul>
<h2 id="lsb">LSB</h2>
<p>LSB stands for Least Significant Bit, the least significant bit. The number of images in a PNG file is generally
composed of the three primary colors of RGB (red, green, and blue). Each color occupies 8 bits, and the value range
is <code>0x00</code> to <code>0xFF</code>, that is, there are 256 colors. Color, that is, 16,777,216 colors.</p>
<p>Human eyes can distinguish about 10 million different colors, which means that human eyes cannot distinguish about
6,777,216 remaining colors.</p>
<p>LSB steganography is to modify the lowest binary bit (LSB) of the RGB color components, each color will have 8 bits, LSB
steganography is to modify the lowest 1 bit in the image number, and human eyes will not notice the before and after
Change, each pixel can carry 3 bits of information.</p>
<p><img alt="lsb" src="../../../assets/img/pictures/lsb.jpg" /></p>
<p>If you are looking for such hidden traces of LSB, there is a
tool <a href="http://www.caesum.com/handbook/Stegsolve.jar">Stegsolve</a> is an artifact that can assist us in our analysis.</p>
<p>You can observe the information of each channel through the buttons below, for example, view the information of the
lowest 8th bit plane of the R channel.</p>
<p><img alt="lsb1" src="../../../assets/img/pictures/lsb1.png" /></p>
<p>When using Stegsolve to view the information of LSB, you must carefully catch the abnormal points and catch the clues of
LSB steganography.</p>
<h3 id="example_1">Example</h3>
<details class="example"><summary>HCTF - 2016 - Misc</summary><p>The information of this question is hidden in the lowest bits of the three RGB channels, and the channel can be
specified for extraction with the help of <code>Stegsolve--&gt;Analyse--&gt;Data Extract</code>.</p>
<p><img alt="hctfsolve" src="../../../assets/img/pictures/hctfsolve.png" /></p>
<p>You can find the <code>zip</code> header. After saving it as a compressed package with <code>save bin</code>, open and run the ELF file 
in it to get the final flag.</p>
<p>More research on LSB can be found <a href="https://zhuanlan.zhihu.com/p/23890677">here</a>.</p>
</details>
<h2 id="tools">Tools</h2>
<ul>
<li><a href="http://domnit.org/stepic/doc/">Stepic</a></li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../jpg" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                JPG (JPEG)
              </div>
            </div>
          </a>
        
        
          <a href="../gif" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                GIF
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2021 Illia Novak
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/anakilivo" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/in/illia-novak/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
      
      
      <a href="mailto:anakilivo@gmail.com" target="_blank" rel="noopener" title="" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.53cc9318.min.js"></script>
      <script src="../../../assets/javascripts/bundle.e9c9f54f.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: [],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>