
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="anakilivo">
      
      
      <link rel="shortcut icon" href="../../../assets/horde.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.7">
    
    
      
        <title>Zip - Horde Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.39b8e14a.min.css">
        
          
          
          <meta name="theme-color" content="#ef5552">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#file-structure" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../.." title="Horde Wiki" class="md-header-nav__button md-logo" aria-label="Horde Wiki">
      
  <img src="../../../assets/horde.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Horde Wiki
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Zip
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/anakilivo/wiki/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"/></svg>
  </div>
  <div class="md-source__repository">
    anakilivo/wiki
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Horde Wiki" class="md-nav__button md-logo" aria-label="Horde Wiki">
      
  <img src="../../../assets/horde.png" alt="logo">

    </a>
    Horde Wiki
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/anakilivo/wiki/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"/></svg>
  </div>
  <div class="md-source__repository">
    anakilivo/wiki
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
      
      <label class="md-nav__link" for="nav-2">
        Misc
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Misc" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          Misc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1" checked>
      
      <label class="md-nav__link" for="nav-2-1">
        Archive
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Archive" data-md-level="2">
        <label class="md-nav__title" for="nav-2-1">
          <span class="md-nav__icon md-icon"></span>
          Archive
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rar" class="md-nav__link">
        Rar
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Zip
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="" class="md-nav__link md-nav__link--active">
        Zip
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#file-structure" class="md-nav__link">
    File Structure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-attack" class="md-nav__link">
    Main attack
  </a>
  
    <nav class="md-nav" aria-label="Main attack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#blasting" class="md-nav__link">
    Blasting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crc32" class="md-nav__link">
    CRC32
  </a>
  
    <nav class="md-nav" aria-label="CRC32">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle" class="md-nav__link">
    Principle
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clear-text-attack" class="md-nav__link">
    Clear text attack
  </a>
  
    <nav class="md-nav" aria-label="Clear text attack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle_1" class="md-nav__link">
    Principle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    Tools
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudo-encryption" class="md-nav__link">
    Pseudo encryption
  </a>
  
    <nav class="md-nav" aria-label="Pseudo encryption">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle_2" class="md-nav__link">
    Principle
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2" >
      
      <label class="md-nav__link" for="nav-2-2">
        Audio
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Audio" data-md-level="2">
        <label class="md-nav__title" for="nav-2-2">
          <span class="md-nav__icon md-icon"></span>
          Audio
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../audio/introduction" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3" >
      
      <label class="md-nav__link" for="nav-2-3">
        Disc Memory
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Disc Memory" data-md-level="2">
        <label class="md-nav__title" for="nav-2-3">
          <span class="md-nav__icon md-icon"></span>
          Disc Memory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../disk-memory/introduction" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4" >
      
      <label class="md-nav__link" for="nav-2-4">
        Encode
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Encode" data-md-level="2">
        <label class="md-nav__title" for="nav-2-4">
          <span class="md-nav__icon md-icon"></span>
          Encode
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../encode/communication" class="md-nav__link">
        Communication
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../encode/encodings" class="md-nav__link">
        Encodings
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../encode/modern" class="md-nav__link">
        Modern
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5" >
      
      <label class="md-nav__link" for="nav-2-5">
        Pictures
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pictures" data-md-level="2">
        <label class="md-nav__title" for="nav-2-5">
          <span class="md-nav__icon md-icon"></span>
          Pictures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../pictures/introduction" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../pictures/jpg" class="md-nav__link">
        JPG (JPEG)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../pictures/png" class="md-nav__link">
        PNG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../pictures/gif" class="md-nav__link">
        GIF
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6" >
      
      <label class="md-nav__link" for="nav-2-6">
        Other
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Other" data-md-level="2">
        <label class="md-nav__title" for="nav-2-6">
          <span class="md-nav__icon md-icon"></span>
          Other
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/pyc" class="md-nav__link">
        Pyc
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
      
      <label class="md-nav__link" for="nav-3">
        Web
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Web" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Web
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/introduction" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/php" class="md-nav__link">
        PHP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/sqli" class="md-nav__link">
        Sqli
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/xss" class="md-nav__link">
        XSS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/ssrf" class="md-nav__link">
        SSRF
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/csrf" class="md-nav__link">
        CSRF
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
      
      <label class="md-nav__link" for="nav-4">
        Crypto
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Crypto" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          Crypto
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/introduction" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2" >
      
      <label class="md-nav__link" for="nav-4-2">
        Asimmetric
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Asimmetric" data-md-level="2">
        <label class="md-nav__title" for="nav-4-2">
          <span class="md-nav__icon md-icon"></span>
          Asimmetric
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-2-1" type="checkbox" id="nav-4-2-1" >
      
      <label class="md-nav__link" for="nav-4-2-1">
        Lattice
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Lattice" data-md-level="3">
        <label class="md-nav__title" for="nav-4-2-1">
          <span class="md-nav__icon md-icon"></span>
          Lattice
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/lattice/introduction" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/lattice/overview" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/lattice/lattice-reduction" class="md-nav__link">
        Lattice reduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/lattice/cvp" class="md-nav__link">
        CVP
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-2-2" type="checkbox" id="nav-4-2-2" >
      
      <label class="md-nav__link" for="nav-4-2-2">
        Discrete Log
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Discrete Log" data-md-level="3">
        <label class="md-nav__title" for="nav-4-2-2">
          <span class="md-nav__icon md-icon"></span>
          Discrete Log
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/discrete-log/introduction" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/discrete-log/elgamal" class="md-nav__link">
        ElGamal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/discrete-log/ecc" class="md-nav__link">
        ECC
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-2-3" type="checkbox" id="nav-4-2-3" >
      
      <label class="md-nav__link" for="nav-4-2-3">
        Rsa
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Rsa" data-md-level="3">
        <label class="md-nav__title" for="nav-4-2-3">
          <span class="md-nav__icon md-icon"></span>
          Rsa
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/rsa/introduction" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../crypto/asymmetric/knapsack" class="md-nav__link">
        Knapsack
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#file-structure" class="md-nav__link">
    File Structure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-attack" class="md-nav__link">
    Main attack
  </a>
  
    <nav class="md-nav" aria-label="Main attack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#blasting" class="md-nav__link">
    Blasting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crc32" class="md-nav__link">
    CRC32
  </a>
  
    <nav class="md-nav" aria-label="CRC32">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle" class="md-nav__link">
    Principle
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clear-text-attack" class="md-nav__link">
    Clear text attack
  </a>
  
    <nav class="md-nav" aria-label="Clear text attack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle_1" class="md-nav__link">
    Principle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    Tools
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudo-encryption" class="md-nav__link">
    Pseudo encryption
  </a>
  
    <nav class="md-nav" aria-label="Pseudo encryption">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle_2" class="md-nav__link">
    Principle
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/anakilivo/wiki/edit/main/docs/misc/archive/zip.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Zip</h1>
                
                <ul>
<li><a href="../zip.ru">русский</a></li>
</ul>
<h2 id="file-structure">File Structure</h2>
<p>The <code>ZIP</code> file is mainly composed of three parts, respectively</p>
<table>
<thead>
<tr>
<th align="center">Compressed Source File Data Area</th>
<th align="center">Core Directory</th>
<th align="center">Directory End</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">local file header + file data + data descriptor</td>
<td align="center">central directory</td>
<td align="center">end of central directory record</td>
</tr>
</tbody>
</table>
<p>Each compressed source file or directory in the compressed source file data area is a record, where</p>
<ul>
<li><em>local file header</em> - the file header is used to identify the beginning of the file, and the information of the
  compressed file is recorded. The file header identifier here starts with a fixed value of <code>50 4B 03 04</code>(hex), 
  <code>PK\x03\x04</code>(bytes) and is also important for the header of <code>ZIP</code>.</li>
<li><em>file data</em> - file data records the data of the corresponding compressed file</li>
<li><em>data descriptor</em> - the data descriptor is used to identify the end of compression of the file. This structure will
  only appear if the 3 bit of the general tag field in the corresponding <em>local file header</em> is set to 1. After
  compressing the file source data</li>
<li><em>Central directory</em> - core directory</li>
<li>The directory information of the compressed file is recorded, and each record in the data area corresponds to one
  piece of data in the compressed source file data area.</li>
</ul>
<table>
<thead>
<tr>
<th align="center">Offset</th>
<th align="center">Bytes</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">4</td>
<td align="center">Central directory file header signature = 0x02014b50</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">2</td>
<td align="center">Version made by</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">2</td>
<td align="center">Version needed to extract (minimum)</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">2</td>
<td align="center">General purpose bit flag</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">2</td>
<td align="center">Compression method</td>
</tr>
<tr>
<td align="center">12</td>
<td align="center">2</td>
<td align="center">File last modification time</td>
</tr>
<tr>
<td align="center">14</td>
<td align="center">2</td>
<td align="center">File last modification date</td>
</tr>
<tr>
<td align="center">16</td>
<td align="center">4</td>
<td align="center">CRC-32</td>
</tr>
<tr>
<td align="center">20</td>
<td align="center">4</td>
<td align="center">Compressed size</td>
</tr>
<tr>
<td align="center">24</td>
<td align="center">4</td>
<td align="center">Uncompressed size</td>
</tr>
<tr>
<td align="center">28</td>
<td align="center">2</td>
<td align="center">File name length (n)</td>
</tr>
<tr>
<td align="center">30</td>
<td align="center">2</td>
<td align="center">Extra field length (m)</td>
</tr>
<tr>
<td align="center">32</td>
<td align="center">2</td>
<td align="center">File comment length (k)</td>
</tr>
<tr>
<td align="center">34</td>
<td align="center">2</td>
<td align="center">Disk number where file starts</td>
</tr>
<tr>
<td align="center">36</td>
<td align="center">2</td>
<td align="center">Internal file attributes</td>
</tr>
<tr>
<td align="center">38</td>
<td align="center">4</td>
<td align="center">External file attributes</td>
</tr>
<tr>
<td align="center">42</td>
<td align="center">4</td>
<td align="center">Relative offset of local header</td>
</tr>
<tr>
<td align="center">46</td>
<td align="center">n</td>
<td align="center">File name</td>
</tr>
<tr>
<td align="center">46+n</td>
<td align="center">m</td>
<td align="center">Extra field</td>
</tr>
<tr>
<td align="center">46+n+m</td>
<td align="center">k</td>
<td align="center">File comment</td>
</tr>
</tbody>
</table>
<ul>
<li><em>End of central directory record(EOCD)</em> - directory end identifier</li>
<li>The end of directory identifier exists at the end of the entire archive package and is used to mark the end of
  compressed directory data. Each compressed file must have one and only one <em>EOCD</em> record.</li>
</ul>
<p>See <a href="https://pkware.cachefly.net/webdocs/APPNOTE/APPNOTE-6.2.0.txt">Official Documentation</a> for more details.</p>
<h2 id="main-attack">Main attack</h2>
<h3 id="blasting">Blasting</h3>
<p>Here are two tools for blasting.</p>
<ul>
<li>Windows - ARCHPR</li>
</ul>
<p><img alt="archpr" src="../../../assets/img/zip/archpr.png" /></p>
<p>Violent enumeration, running dictionaries, plaintext attacks, everything.</p>
<ul>
<li>Linux - <a href="https://github.com/hyc/fcrackzip">fcrackzip</a></li>
</ul>
<div class="highlight"><pre><span></span><code>-b Specifies that the mode is bursting,
-c1 specifies the password <span class="nb">type</span> as a pure number, other types can be rtfm,
-u this parameter is very important or does not display the cracked password,
-l <span class="m">5</span>-6 can specify the length

root@kali:fcrackzip -b -c1 -u test.zip
</code></pre></div>
<h3 id="crc32">CRC32</h3>
<h4 id="principle">Principle</h4>
<p><a href="https://en.wikipedia.org/wiki/Cyclic_redundancy_check"><code>CRC</code></a> itself means "redundant check code", and <code>CRC32</code> means
that a check value of <code>32 bit</code> ( <code>8</code> hexadecimal number) is generated. Since <code>CRC32</code> generates a check value, every
bit <code>bit</code> of the source data block participates in the calculation, so even if only one bit changes in the data block, a
different <code>CRC32</code> value will be obtained.</p>
<p>The <code>CRC32</code> checksum appears in many files such as the <code>png</code> file, as well as the <code>CRC32</code> checksum in <code>ZIP</code>. It is worth
noting that <code>CRC32</code> in <code>ZIP</code> is the checksum value of the unencrypted file.</p>
<p>This has led to an attack based on <code>CRC32</code>.</p>
<ul>
<li>There is very little content in the file (mostly in the game, it is about <code>4 bytes</code>)</li>
<li>An encrypted password is very long</li>
</ul>
<p>Instead of blasting the password of the compressed package, we directly blast the contents of the source file (usually
visible strings) to obtain the desired information.</p>
<h3 id="example">Example</h3>
<details class="example"><summary>Abctf-2016: Zippy</summary><p>For example, we create a new <code>flag.txt</code> with the content <code>123</code> and encrypt it with the password <code>!QAZXSW@#EDCVFR$</code>.</p>
<p><img alt="example-1" src="../../../assets/img/zip/example-1.png" /></p>
<p>And we went to calculate the <code>CRC32</code> value of the file and found that it matches the <code>CRC32</code> value in the above 
figure.</p>
<div class="highlight"><pre><span></span><code>File: flag.txt
Size: <span class="m">3</span>
Time: Tue, <span class="m">29</span> Aug <span class="m">2017</span> <span class="m">10</span>:38:10 +0800
MD5: 202cb962ac59075b964b07152d234b70
SHA1: 40bd001563085fc35165329ea1ff5c5ecbdbbeef
CRC32: 884863D2
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code>CRC32</code> value of all possible strings we enumerated during blasting is to correspond to the <code>CRC32</code>
value in the compressed source file data area.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">ascii_letters</span><span class="p">,</span> <span class="n">digits</span>

<span class="n">alph</span> <span class="o">=</span> <span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">digits</span> <span class="o">+</span> <span class="s1">&#39;+/=&#39;</span>
<span class="n">crcdict</span> <span class="o">=</span> <span class="p">{}</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;computing all possible CRCs...&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">alph</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">st</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
    <span class="n">crc</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="n">binascii</span><span class="o">.</span><span class="n">crc32</span><span class="p">(</span><span class="n">st</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="n">crcdict</span><span class="p">[</span><span class="n">crc</span><span class="p">]</span> <span class="o">=</span> <span class="n">st</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done!&#39;</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;flag.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">crc</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">18</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
<span class="k">if</span> <span class="n">crc</span> <span class="ow">in</span> <span class="n">crcdict</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">crcdict</span><span class="p">[</span><span class="n">crc</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FAILED!&quot;</span><span class="p">)</span>
</code></pre></div>
<p>According to the file size in each compressed package, it can be inferred that the <code>CRC32</code> attack method is used, and
the contents of each compressed package are obtained, and then an encrypted compressed package is obtained after
the <code>Base64</code> decoding, and the blast is obtained by <code>flag</code>.</p>
</details>
<h3 id="clear-text-attack">Clear text attack</h3>
<h4 id="principle_1">Principle</h4>
<ol>
<li>An encrypted compressed file</li>
<li>Compressed files for compressed files, such as <code>2345</code>, pressure, <code>WinRAR</code>, <code>7z</code>. <code>ZIP</code> version number, etc., can be
   understood through file attributes. If it is a <code>Linux</code> platform, use <code>zipinfo -v</code> to view the details of a <code>ZIP</code>
   package, including encryption algorithms, etc.</li>
<li>Know some of the contiguous content of a file in the archive (at least <code>12 bytes</code>)</li>
</ol>
<p>If you already know part of the encrypted file, such as the <code>readme.txt</code> file found on a website, you can start trying
to crack it.</p>
<p>First, package this plaintext file into a <code>ZIP</code> package, such as <code>readme.txt</code> into <code>readme.zip</code>.</p>
<p>After the packaging is complete, you need to confirm that the compression algorithm used by both is the same. A simple
way to judge is to open the file with <code>WinRAR</code>, and the same file is compressed with the same volume. If they are the
same, it basically means that the compression algorithm you are using is correct. If it is different, try another
compression algorithm.</p>
<h4 id="tools">Tools</h4>
<ul>
<li>Windows - ARCHPR</li>
<li>Linux <a href="http://www.unix-ag.uni-kl.de/~conrad/krypto/pkcrack.html">PKCrack</a></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is recommended to use the <code>ARCHPR</code> of <code>Windows</code>. One is faster and more stable.</p>
</div>
<h4 id="example_1">Example</h4>
<details class="example"><summary>2015 Guangzhou Strong Net Cup: Blasting?</summary><p>First of all, we got such a question, the title of the title is <strong>Blasting?</strong>, it is obvious that this problem is
definitely to use a cracking tool, very violent.</p>
<p><strong>First step, analyze the compressed package file</strong></p>
<p>After we downloaded this tarball, we saw that the file name is <strong>*.zip</strong>. We can immediately think of several ways 
to crack the zip package. We extract the zip file and find that there are two files, respectively, <code>Desktop.zip</code>
and <code>readme.txt</code>, let's see what is written in <code>readme.txt</code>?</p>
<p><img alt="readme" src="../../../assets/img/zip/readme.png" /></p>
<p>After opening it turned out to be <code>qianwanbuyaogeixuanshoukandao!!!</code>, the questioner did not want the player to see,
this question is still a bit interesting. Let&#39;s take a look at the <code>Desktop.zip</code>. We can see that there is
a <code>readme.txt</code> file and a <code>answer</code> folder. There is a <code>key.txt</code> file in the <code>answer</code> folder. <code>flag</code> should be Hidden
here.</p>
<p><strong>Step 2, analyze the crack method</strong></p>
<p>This topic got the hand, we first found that the extracted file and the <code>Desktop.zip</code> tarball contain the same
file <code>readme.txt</code>, and did not give other relevant information, and the file size is greater than <code>12Byte</code>, We 
compare the <code>readme.txt</code> in the compressed package with the value of <code>CRC32</code> in <code>readme.txt</code> in the original 
compressed package. We find that the two values are the same, which means that the extracted <code>readme.txt</code> is 
encrypted and compressed. The plaintext of <code>readme.txt</code> in the package, so we can boldly guess that this is 
probably a plaintext encryption.</p>
<p><img alt="compare" src="../../../assets/img/zip/compare.png" /></p>
<p><strong>Step 3, try plaintext attack</strong></p>
<p>Now that we know that it is a plaintext attack, we will crack the compressed package. Since the extracted readme.txt
is the plaintext of <code>readme.txt</code> in the encrypted archive, compress <code>readme.txt</code> to * <em>.zip</em>* file, then fill in the
corresponding path in the software to start plaintext attack, here we will introduce different methods of clear-text
attack under <code>Windows</code> and <code>Ubuntu</code>.</p>
<p>Method 1, <code>pkcrack</code> for plaintext attack</p>
<p>Download link: <a href="https://www.unix-ag.uni-kl.de/~conrad/krypto/pkcrack.html">pkcrack</a></p>
<p>We can just write a <code>shell</code> script to download it:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash -ex</span>
wget https://www.unix-ag.uni-kl.de/~conrad/krypto/pkcrack/pkcrack-1.2.2.tar.gz
tar xzf pkcrack-1.2.2.tar.gz
<span class="nb">cd</span> pkcrack-1.2.2/src
make
mkdir -p ../../bin
cp extract findkey makekey pkcrack zipdecrypt ../../bin
<span class="nb">cd</span> ../../
</code></pre></div>
<p>Save the file to <code>pkcrack-install.sh</code> and run it to the current directory, giving it an execute permission <code>x</code>.</p>
<div class="highlight"><pre><span></span><code>chmod <span class="m">777</span> install.sh
</code></pre></div>
<p>Or directly:</p>
<div class="highlight"><pre><span></span><code>chmod u+x install.sh
</code></pre></div>
<p>Then run <code>./pkcrack-install.sh</code></p>
<p>Then a folder of <code>bin</code> will be generated in the current directory. We will directly enter the <code>bin</code> folder and see
the <code>pkcrack</code> file, which will directly crack the file.</p>
<div class="highlight"><pre><span></span><code>./pkcrack -c readme.txt -p readme.txt -C ~/download/misc/Desktop.zip -P ~/download/misc/readme.zip -d ~/decrypt.zip
</code></pre></div>
<p>The parameter options we used are as follows:</p>
<div class="highlight"><pre><span></span><code>-C: target file to be cracked (including path)
-c: crack the name of the plaintext file in the file (the path does not include the system path, starting from the 
zip file level)
-P: compressed plaintext file
-p: the name of the plaintext file in the compressed plaintext file (that is, the location of readme.txt in readme.zip)
-d: Specify the file name and the absolute path where it is located, and output the decrypted zip file.
</code></pre></div>
<p>The results after decryption are as follows:</p>
<p><img alt="pkcrack-to-flag" src="../../../assets/img/zip/pkcrack-to-flag-01.png" /></p>
<p><img alt="pkcrack-to-flag" src="../../../assets/img/zip/pkcrack-to-flag-02.png" /></p>
<p><img alt="pkcrack-to-flag" src="../../../assets/img/zip/pkcrack-to-flag-03.png" /></p>
<p><img alt="pkcrack-to-flag" src="../../../assets/img/zip/pkcrack-to-flag-04.png" /></p>
<p>We have come to the final flag: <strong><code>flag{7ip_Fi13_S0m3tim3s_s0_3a5y@}</code></strong></p>
<p><strong>The pit is coming</strong></p>
<p>It seems that everything is going well, but it took more than two hours.</p>
<p>Method 2, <code>ARCHPR</code> for plaintext attack</p>
<p>First of all, I suggest that you have the <code>ARCHPR 4.53</code> version. I tested it successfully in this version. The
successful screenshots are as follows:</p>
<p><img alt="success" src="../../../assets/img/zip/success.png" /></p>
<p>I believe many of my friends encountered the following situation when using <code>ARCHPR</code>:</p>
<p><img alt="error" src="../../../assets/img/zip/error.png" /></p>
<p>I was in a state of collapse at the time, and this will happen.</p>
<p>In later learning, it was found that files compressed with <code>7z</code> were decompressed with <code>7z</code>, which is a file format that
uses multiple compression algorithms for data compression, and the traditional <code>zip</code>
, <code>rar Compared with it, its compression ratio is larger, and the compression algorithm used is different. 
Naturally, there may be a mismatch. Therefore, we must analyze the original person when decompressing the original 
compressed package and encrypting the file. What is the way to encrypt and decrypt, so the problem of this 
question is obvious. After verification, I found out that the subject is compressed with</code>7z`.</p>
<p><strong>Try again</strong></p>
<p>We have found this problem, we go to the official website to download <code>7zip</code>: <a href="https://www.7-zip.org/">https://www.7-zip.org/</a></p>
<p>Then we decompress the original compressed file with <code>7z</code>, and then compress <code>readme.txt</code> with 7z. Then we can use
the <code>ARCHPR</code> for plaintext attacks.</p>
<p>The results are as follows:</p>
<p><img alt="attack-success" src="../../../assets/img/zip/attack-success.png" /></p>
<p>We unzipped <code>Desktop_decrypted.zip</code> and checked <code>key.txt</code> in the <code>answer</code> directory.</p>
<p>So the final flag is: <strong><code>flag{7ip_Fi13_S0m3tim3s_s0_3a5y@}</code></strong></p>
</details>
<h3 id="pseudo-encryption">Pseudo encryption</h3>
<h4 id="principle_2">Principle</h4>
<p>In the <em>core directory area</em> in the <code>ZIP</code> format above, we emphasize a <code>2 bytes</code> called the general purpose bit flag,
which has different meanings.</p>
<div class="highlight"><pre><span></span><code>Bit 0: If set, indicates that the file is encrypted.
(For Method 6 - Imploding)
Bit 1: If the compression method used was type 6,
     Imploding, then this bit, if set, indicates
     an 8K sliding dictionary was used.  If clear,
     then a 4K sliding dictionary was used.
...
Bit 6: Strong encryption.  If this bit is set, you should
     set the version needed to extract value to at least
     50 and you must also set bit 0.  If AES encryption
     is used, the version needed to extract value must
     be at least 51.
...
</code></pre></div>
<p>In <code>010Editor</code> we tried to modify this <code>1</code> bit to <code>0 -&gt; 1</code>.</p>
<p><img alt="4" src="../../../assets/img/zip/4.png" /></p>
<p>Open the file again and find that you have requested a password.</p>
<p><img alt="5" src="../../../assets/img/zip/5.png" /></p>
<p>Modify the method of pseudo encryption:</p>
<ul>
<li>Modify the universal bit mark in <code>16</code></li>
<li><code>binwalk -e</code> ignores pseudo encryption</li>
<li>In the <code>Mac OS</code> and some <code>Linux</code> (such as <code>Kali</code>) systems, you can directly open the pseudo-encrypted <code>ZIP</code> package.</li>
<li>Detect pseudo-encrypted gadget <code>ZipCenOp.jar</code></li>
<li>Sometimes with the fix function of <code>WinRar</code> (this method sometimes has a miraculous effect, not only for pseudo
  encryption)</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../rar" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Rar
              </div>
            </div>
          </a>
        
        
          <a href="../../audio/introduction" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Introduction
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2021 Illia Novak
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/anakilivo" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/in/illia-novak/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
      
      
      <a href="mailto:anakilivo@gmail.com" target="_blank" rel="noopener" title="" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.53cc9318.min.js"></script>
      <script src="../../../assets/javascripts/bundle.e9c9f54f.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: [],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>